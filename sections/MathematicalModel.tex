\section{Mathematical Model}
Based on data volume rates, we do need mathematical models to identify which are the source addresses that may be proponents of an attack. Since we categorize data, using big data framework in order to analyze log files and generate, for simplicity we explain each field by referring to a single entry which represents an exchange between a source ip and server.

\begin{itemize}
	\item \textit{n\_packets} \\ Represents the amount of packets.
	\item \textit{total\_volume} \\ It is the sum of all packets length.
	\item \textit{time\_difference} \\ It is the time difference between the first communication and the last one, we consider it as a time window.
	\item \textit{ratio\_vol\_td} \\ Represents the volume over seconds exchanged during the time window.
\end{itemize}

The mathematical model must be able judge the data by using a threshold, in our case the maximal volume of traffic per second supported by the server under analysis represents this threshold. Other mathematical model are treated in\cite{detection_by_path_analaysis}. 
This threshold can be estimated by adding an $\alpha$ factor to the mean of volume exchanged during the time of records.

Using \textit{python} in order to manipulate the results returned by \textit{Pig-latin} we decide to use \textbf{standard deviation} as mathematical model to identify suspicious source address.
The formula for the sample standard deviation is

\begin{equation}
\label{eq:standard_dev}
	s = \sqrt{\frac{1}{N-1}\sum_{i=1}^N(x_i - \bar{x})^2}
\end{equation}
where $x_1, x_2\ ...\ x_n$ are the samples values, $\bar{x}$ is the mean and $N$ is the number of sample in the dataset generated by \textit{Pig-latin} script. We decide to output two plots, \textit{data analysis} which figure out the amount of data, in terms of megabyte, exchanged between a source and the server. \textit{Volume analysis} is like the previous one but represents the data volumes per second exchanged between a source and the server, we use these two plots together to identify the data flow and thanks to these attackers may be detected more easily.
